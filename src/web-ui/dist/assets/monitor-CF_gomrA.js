import{f as m,r as p}from"./vendor-EuZm8Jb1.js";import{a as c}from"./index-DoWhx5pT.js";const v="http://localhost:8080",S=m("monitor",()=>{const i=p([]),n=p(!1),u=p(null),o=p(localStorage.getItem("token")),d=()=>({Authorization:`Bearer ${o.value}`});return{lists:i,isLoading:n,error:u,fetchLists:async t=>{var a,r;if(!o.value)return!1;n.value=!0,u.value=null;try{const e=t?{list_type:t}:{},s=await c.get(`${v}/api/v1/monitor/lists`,{headers:d(),params:e});return i.value=s.data,!0}catch(e){return u.value=((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.detail)||"加载失败",!1}finally{n.value=!1}},createList:async(t,a,r="stock")=>{var e,s;if(!o.value)return!1;n.value=!0,u.value=null;try{const l=await c.post(`${v}/api/v1/monitor/lists`,{name:t,description:a,list_type:r},{headers:d()});return i.value.push(l.data),l.data}catch(l){return u.value=((s=(e=l.response)==null?void 0:e.data)==null?void 0:s.detail)||"创建失败",!1}finally{n.value=!1}},updateList:async(t,a,r)=>{var e,s;if(!o.value)return!1;n.value=!0,u.value=null;try{const l=await c.put(`${v}/api/v1/monitor/lists/${t}`,{name:a,description:r},{headers:d()}),f=i.value.findIndex(y=>y.id===t);return f!==-1&&(i.value[f]=l.data),l.data}catch(l){return u.value=((s=(e=l.response)==null?void 0:e.data)==null?void 0:s.detail)||"更新失败",!1}finally{n.value=!1}},deleteList:async t=>{var a,r;if(!o.value)return!1;n.value=!0,u.value=null;try{return await c.delete(`${v}/api/v1/monitor/lists/${t}`,{headers:d()}),i.value=i.value.filter(e=>e.id!==t),!0}catch(e){return u.value=((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.detail)||"删除失败",!1}finally{n.value=!1}},addItem:async(t,a)=>{var r,e;if(!o.value)return!1;n.value=!0,u.value=null;try{const s=await c.post(`${v}/api/v1/monitor/lists/${t}/items`,a,{headers:d()}),l=i.value.find(f=>f.id===t);return l&&l.items.push(s.data),s.data}catch(s){return u.value=((e=(r=s.response)==null?void 0:r.data)==null?void 0:e.detail)||"添加失败",!1}finally{n.value=!1}},updateItem:async(t,a)=>{var r,e;if(!o.value)return!1;n.value=!0,u.value=null;try{const s=await c.put(`${v}/api/v1/monitor/items/${t}`,a,{headers:d()});for(const l of i.value){const f=l.items.findIndex(y=>y.id===t);if(f!==-1){l.items[f]=s.data;break}}return s.data}catch(s){return u.value=((e=(r=s.response)==null?void 0:r.data)==null?void 0:e.detail)||"更新失败",!1}finally{n.value=!1}},deleteItem:async t=>{var a,r;if(!o.value)return!1;n.value=!0,u.value=null;try{await c.delete(`${v}/api/v1/monitor/items/${t}`,{headers:d()});for(const e of i.value){const s=e.items.findIndex(l=>l.id===t);if(s!==-1){e.items.splice(s,1);break}}return!0}catch(e){return u.value=((r=(a=e.response)==null?void 0:a.data)==null?void 0:r.detail)||"删除失败",!1}finally{n.value=!1}},getListsByType:t=>i.value.filter(a=>a.list_type===t),getListById:t=>i.value.find(a=>a.id===t)}});export{S as u};
