import{d as re,o as ue,c as i,p as e,I as p,J as y,u as ce,E as D,z as o,B as _,C as H,K as ve,A as $,b as B,H as T,T as O,x as pe,r as v,g as W,e as d,y as q,L as X,G as E,D as L}from"./vendor-EuZm8Jb1.js";import{u as ye,a as M}from"./index-B61lcHf_.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const _e={class:"stock-monitor-page"},he={class:"page-header"},fe={class:"module-nav"},ke=["onClick"],be={class:"module-icon"},ge={class:"module-name"},Ce={class:"header-right"},we={class:"page-main"},$e={class:"monitor-container"},Le={class:"sidebar"},Me={class:"list-group"},Ae=["onClick"],xe={class:"list-info"},De={class:"list-name"},Se={class:"list-count"},Re={class:"list-actions"},Ve=["onClick"],qe=["onClick"],Fe={class:"main-content"},Ue={key:0,class:"loading-state"},He={key:1,class:"error-state"},Be={key:2,class:"list-content"},Te={class:"content-header"},Oe={class:"list-title"},Ee={class:"quick-search"},Ke={class:"stock-list"},ze={key:0,class:"empty-state"},Ne={class:"stock-header"},Je={class:"stock-info"},Pe={class:"stock-code"},Ie={class:"stock-name"},je={class:"stock-tags"},Ge={class:"stock-config"},Qe={class:"config-item"},We={class:"config-item"},Xe={class:"config-item"},Ye={class:"stock-actions"},Ze=["onClick"],es={key:3,class:"no-list-selected"},ss={key:0,class:"search-panel"},ts={class:"search-panel-header"},as={class:"search-results"},ls={key:0,class:"loading"},ns=["onClick"],os={class:"result-info"},is={class:"result-code"},ds={class:"result-name"},rs={class:"modal"},us={class:"modal-header"},cs={class:"modal-body"},vs={class:"form-group"},ps={class:"form-group"},ys={class:"modal-footer"},ms={class:"modal modal-large"},_s={class:"modal-header"},hs={key:0,class:"modal-body"},fs={class:"stock-preview"},ks={class:"stock-code"},bs={class:"stock-name"},gs={class:"config-section"},Cs={class:"form-row"},ws={class:"form-group"},$s=["value"],Ls={class:"form-group"},Ms=["value"],As={class:"form-group checkbox-group"},xs={class:"config-section"},Ds={class:"checkbox-group"},Ss=["value"],Rs={class:"config-section"},Vs={class:"tag-selector"},qs=["value"],Fs={class:"modal-footer"},Us=re({__name:"StockMonitorView",setup(Hs){const S=pe(),K=ye(),b="/api/v1",g="http://localhost:8080",C=()=>{const l=K.token;return l?{Authorization:`Bearer ${l}`}:{}},z=v("stock-monitor"),Y=[{id:"stock-monitor",name:"è‚¡ç¥¨ç›‘è§†",icon:"ğŸ“Š"},{id:"fund-monitor",name:"åŸºé‡‘ç›‘è§†",icon:"ğŸ’°"},{id:"analytics",name:"æ•°æ®åˆ†æ",icon:"ğŸ“ˆ"},{id:"alerts",name:"é¢„è­¦ä¸­å¿ƒ",icon:"ğŸ””"}],c=v([]),F=v(!1),R=v(""),N=async()=>{var l,t;F.value=!0,R.value="";try{const s=await M.get(`${g}${b}/monitor/lists`,{params:{list_type:"stock"},headers:C()});c.value=s.data.map(a=>({...a,created_at:new Date(a.created_at),updated_at:new Date(a.updated_at),items:a.items.map(r=>({...r,created_at:new Date(r.created_at),updated_at:new Date(r.updated_at)}))})),console.log("ç›‘æ§åˆ—è¡¨åŠ è½½æˆåŠŸ:",c.value)}catch(s){console.error("è·å–ç›‘æ§åˆ—è¡¨å¤±è´¥:",s),R.value=((t=(l=s.response)==null?void 0:l.data)==null?void 0:t.detail)||"è·å–ç›‘æ§åˆ—è¡¨å¤±è´¥",c.value=[]}finally{F.value=!1}},h=v(null),u=v(null),f=v(!1),A=v(""),J=v([]),U=v(!1),x=v(!1),n=v(null),w=v(!1),V=v(null),P=[{value:"realtime",label:"å®æ—¶"},{value:"daily",label:"æ¯æ—¥"},{value:"weekly",label:"æ¯å‘¨"},{value:"manual",label:"æ‰‹åŠ¨"}],I=[{value:"30",label:"30å¤©"},{value:"90",label:"90å¤©"},{value:"180",label:"180å¤©"},{value:"365",label:"365å¤©"},{value:"all",label:"å…¨éƒ¨"}],Z=[{value:"MA5",label:"MA5"},{value:"MA10",label:"MA10"},{value:"MA20",label:"MA20"},{value:"MA60",label:"MA60"},{value:"RSI",label:"RSI"},{value:"MACD",label:"MACD"},{value:"KDJ",label:"KDJ"},{value:"BOLL",label:"BOLL"}],ee=["ç§‘æŠ€è‚¡","è“ç­¹","ETF","æ–°èƒ½æº","åŒ»è¯","æ¶ˆè´¹","é“¶è¡Œ","åœ°äº§","å†›å·¥"],m=W(()=>c.value.find(l=>l.id===h.value)||null),j=W(()=>{var l;return((l=m.value)==null?void 0:l.items)||[]}),G=async()=>{A.value.trim()&&(U.value=!0,x.value=!0,setTimeout(()=>{J.value=[{id:"1",code:"000001",name:"å¹³å®‰é“¶è¡Œ",type:"stock",market:"sh",syncFrequency:"daily",syncHistory:!1,historyRange:"30",indicators:[],alerts:[],tags:[]},{id:"2",code:"600036",name:"æ‹›å•†é“¶è¡Œ",type:"stock",market:"sh",syncFrequency:"daily",syncHistory:!1,historyRange:"30",indicators:[],alerts:[],tags:[]},{id:"3",code:"000002",name:"ä¸‡ç§‘A",type:"stock",market:"sz",syncFrequency:"daily",syncHistory:!1,historyRange:"30",indicators:[],alerts:[],tags:[]},{id:"4",code:"600519",name:"è´µå·èŒ…å°",type:"stock",market:"sh",syncFrequency:"daily",syncHistory:!1,historyRange:"30",indicators:[],alerts:[],tags:[]},{id:"5",code:"510300",name:"æ²ªæ·±300ETF",type:"fund",market:"sh",syncFrequency:"daily",syncHistory:!1,historyRange:"30",indicators:[],alerts:[],tags:[]}].filter(l=>l.code.includes(A.value)||l.name.includes(A.value)),U.value=!1},500))},Q=()=>{u.value={id:"",name:"",description:"",created_at:new Date,updated_at:new Date,list_type:"stock",items:[]},f.value=!0},se=l=>{u.value={...l},f.value=!0},te=async()=>{var l,t;if(u.value){try{if(u.value.id){const s=await M.put(`${g}${b}/monitor/lists/${u.value.id}`,{name:u.value.name,description:u.value.description},{headers:C()}),a=c.value.findIndex(r=>r.id===u.value.id);a!==-1&&(c.value[a]={...c.value[a],name:s.data.name,description:s.data.description,updated_at:new Date(s.data.updated_at)})}else{const s=await M.post(`${g}${b}/monitor/lists`,{name:u.value.name,description:u.value.description,list_type:"stock"},{headers:C()}),a={...s.data,created_at:new Date(s.data.created_at),updated_at:new Date(s.data.updated_at),items:[]};c.value.unshift(a),h.value=a.id}}catch(s){console.error("ä¿å­˜åˆ—è¡¨å¤±è´¥:",s),alert(((t=(l=s.response)==null?void 0:l.data)==null?void 0:t.detail)||"ä¿å­˜åˆ—è¡¨å¤±è´¥");return}f.value=!1,u.value=null}},ae=async l=>{var t,s,a;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç›‘æ§åˆ—è¡¨å—ï¼Ÿ"))try{await M.delete(`${g}${b}/monitor/lists/${l}`,{headers:C()}),c.value=c.value.filter(r=>r.id!==l),h.value===l&&(h.value=((t=c.value[0])==null?void 0:t.id)||null)}catch(r){console.error("åˆ é™¤åˆ—è¡¨å¤±è´¥:",r),alert(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.detail)||"åˆ é™¤åˆ—è¡¨å¤±è´¥")}},le=l=>{V.value=l,x.value=!0},ne=l=>{n.value={...l,sync_frequency:"daily",sync_history:!0,history_range:"90",indicators:[],alerts:[],tags:[]},x.value=!1,w.value=!0},oe=async()=>{var l,t;if(!(!n.value||!V.value)){try{const s=await M.post(`${g}${b}/monitor/lists/${V.value}/items`,{code:n.value.code,name:n.value.name,item_type:n.value.item_type,market:n.value.market,sync_frequency:n.value.sync_frequency,sync_history:n.value.sync_history,history_range:n.value.history_range,indicators:n.value.indicators,alerts:n.value.alerts,tags:n.value.tags},{headers:C()}),a=c.value.find(r=>r.id===V.value);a&&a.items.push({...s.data,created_at:new Date(s.data.created_at),updated_at:new Date(s.data.updated_at)})}catch(s){console.error("æ·»åŠ è‚¡ç¥¨å¤±è´¥:",s),alert(((t=(l=s.response)==null?void 0:l.data)==null?void 0:t.detail)||"æ·»åŠ è‚¡ç¥¨å¤±è´¥");return}w.value=!1,n.value=null}},ie=async l=>{var t,s;if(confirm("ç¡®å®šè¦ä»åˆ—è¡¨ä¸­ç§»é™¤è¯¥æ ‡çš„å—ï¼Ÿ"))try{await M.delete(`${g}${b}/monitor/items/${l}`,{headers:C()}),m.value&&(m.value.items=m.value.items.filter(a=>a.id!==l))}catch(a){console.error("åˆ é™¤è‚¡ç¥¨å¤±è´¥:",a),alert(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.detail)||"åˆ é™¤è‚¡ç¥¨å¤±è´¥")}},de=l=>{z.value=l,l==="fund-monitor"?S.push("/fund-monitor"):l==="analytics"?S.push("/analytics"):l==="alerts"&&S.push("/alerts")};return ue(async()=>{K.initAuth(),await N(),c.value.length>0&&(h.value=c.value[0].id)}),(l,t)=>(d(),i("div",_e,[e("header",he,[t[17]||(t[17]=e("div",{class:"header-left"},[e("h1",{class:"logo"},"è‚¡ç¥¨åŸºé‡‘ä¸ªäººç›‘è§†ç³»ç»Ÿ")],-1)),e("div",fe,[(d(),i(p,null,y(Y,s=>e("button",{key:s.id,class:L(["module-btn",{active:z.value===s.id}]),onClick:a=>de(s.id)},[e("span",be,o(s.icon),1),e("span",ge,o(s.name),1)],10,ke)),64))]),e("div",Ce,[e("button",{class:"back-btn",onClick:t[0]||(t[0]=s=>ce(S).push("/dashboard"))}," è¿”å›ä»ªè¡¨ç›˜ ")])]),e("main",we,[e("div",$e,[e("aside",Le,[e("div",{class:"sidebar-header"},[t[18]||(t[18]=e("h3",null,"ç›‘æ§åˆ—è¡¨",-1)),e("button",{class:"add-btn",onClick:Q},"+")]),e("div",Me,[(d(!0),i(p,null,y(c.value,s=>(d(),i("div",{key:s.id,class:L(["list-item",{active:h.value===s.id}]),onClick:a=>h.value=s.id},[e("div",xe,[e("span",De,o(s.name),1),e("span",Se,o(s.items.length)+" ä¸ªæ ‡çš„",1)]),e("div",Re,[e("button",{class:"action-btn",onClick:q(a=>se(s),["stop"])},"ç¼–è¾‘",8,Ve),e("button",{class:"action-btn delete",onClick:q(a=>ae(s.id),["stop"])},"åˆ é™¤",8,qe)])],10,Ae))),128))]),e("div",{class:"sidebar-footer"},[e("button",{class:"add-list-btn",onClick:Q},[...t[19]||(t[19]=[e("span",null,"+",-1),D(" æ–°å»ºç›‘æ§åˆ—è¡¨ ",-1)])])])]),e("section",Fe,[F.value?(d(),i("div",Ue,[...t[20]||(t[20]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"æ­£åœ¨åŠ è½½ç›‘æ§åˆ—è¡¨...",-1)])])):R.value?(d(),i("div",He,[t[21]||(t[21]=e("div",{class:"error-icon"},"âš ï¸",-1)),t[22]||(t[22]=e("h3",null,"åŠ è½½å¤±è´¥",-1)),e("p",null,o(R.value),1),e("button",{class:"btn-primary",onClick:N},"é‡è¯•")])):m.value?(d(),i("div",Be,[e("div",Te,[e("div",Oe,[e("h2",null,o(m.value.name),1),e("p",null,o(m.value.description),1)]),e("button",{class:"add-stock-btn",onClick:t[1]||(t[1]=s=>le(m.value.id))},[...t[23]||(t[23]=[e("span",null,"+",-1),D(" æ·»åŠ æ ‡çš„ ",-1)])])]),e("div",Ee,[_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>A.value=s),type:"text",placeholder:"è¾“å…¥ä»£ç æˆ–åç§°æœç´¢...",onKeyup:ve(G,["enter"])},null,544),[[H,A.value]]),e("button",{class:"search-btn",onClick:G},"æœç´¢")]),e("div",Ke,[j.value.length===0?(d(),i("div",ze,[...t[24]||(t[24]=[e("div",{class:"empty-icon"},"ğŸ“‹",-1),e("h3",null,"æš‚æ— ç›‘æ§æ ‡çš„",-1),e("p",null,"ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ è‚¡ç¥¨æˆ–åŸºé‡‘è¿›è¡Œç›‘æ§",-1)])])):$("",!0),(d(!0),i(p,null,y(j.value,s=>{var a,r;return d(),i("div",{key:s.id,class:"stock-card"},[e("div",Ne,[e("div",Je,[e("span",Pe,o(s.code),1),e("span",Ie,o(s.name),1),e("span",{class:L(["stock-type",s.item_type])},o(s.item_type==="stock"?"è‚¡ç¥¨":"åŸºé‡‘"),3)]),e("div",je,[(d(!0),i(p,null,y(s.tags,k=>(d(),i("span",{key:k,class:"tag"},o(k),1))),128))])]),e("div",Ge,[e("div",Qe,[t[25]||(t[25]=e("label",null,"åŒæ­¥é¢‘ç‡",-1)),e("span",null,o((a=P.find(k=>k.value===s.sync_frequency))==null?void 0:a.label),1)]),e("div",We,[t[26]||(t[26]=e("label",null,"å†å²æ•°æ®",-1)),e("span",null,o((r=I.find(k=>k.value===s.history_range))==null?void 0:r.label),1)]),e("div",Xe,[t[27]||(t[27]=e("label",null,"æŒ‡æ ‡",-1)),e("span",null,o(s.indicators.length>0?s.indicators.join(", "):"æœªé…ç½®"),1)])]),e("div",Ye,[e("button",{class:"stock-btn",onClick:k=>ie(s.id)},"ç§»é™¤",8,Ze)])])}),128))])])):(d(),i("div",es,[...t[28]||(t[28]=[e("div",{class:"empty-icon"},"ğŸ“Š",-1),e("h3",null,"é€‰æ‹©ä¸€ä¸ªç›‘æ§åˆ—è¡¨",-1),e("p",null,"ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ªåˆ—è¡¨ï¼Œæˆ–åˆ›å»ºä¸€ä¸ªæ–°çš„ç›‘æ§åˆ—è¡¨",-1)])]))])])]),B(O,{name:"slide"},{default:T(()=>[x.value?(d(),i("div",ss,[e("div",ts,[t[29]||(t[29]=e("h3",null,"æœç´¢ç»“æœ",-1)),e("button",{class:"close-btn",onClick:t[3]||(t[3]=s=>x.value=!1)},"Ã—")]),e("div",as,[U.value?(d(),i("div",ls,"æœç´¢ä¸­...")):$("",!0),(d(!0),i(p,null,y(J.value,s=>(d(),i("div",{key:s.id,class:"search-result-item",onClick:a=>ne(s)},[e("div",os,[e("span",is,o(s.code),1),e("span",ds,o(s.name),1),e("span",{class:L(["result-type",s.type])},o(s.type==="stock"?"è‚¡ç¥¨":"åŸºé‡‘"),3),e("span",{class:L(["result-market",s.market])},o(s.market==="sh"?"æ²ªå¸‚":"æ·±å¸‚"),3)]),t[30]||(t[30]=e("button",{class:"add-btn-small"},"æ·»åŠ ",-1))],8,ns))),128))])])):$("",!0)]),_:1}),B(O,{name:"fade"},{default:T(()=>{var s;return[f.value?(d(),i("div",{key:0,class:"modal-overlay",onClick:t[8]||(t[8]=q(a=>f.value=!1,["self"]))},[e("div",rs,[e("div",us,[e("h3",null,o((s=u.value)!=null&&s.id?"ç¼–è¾‘ç›‘æ§åˆ—è¡¨":"æ–°å»ºç›‘æ§åˆ—è¡¨"),1),e("button",{class:"close-btn",onClick:t[4]||(t[4]=a=>f.value=!1)},"Ã—")]),e("div",cs,[e("div",vs,[t[31]||(t[31]=e("label",null,"åˆ—è¡¨åç§°",-1)),_(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>u.value.name=a),type:"text",placeholder:"è¾“å…¥åˆ—è¡¨åç§°"},null,512),[[H,u.value.name]])]),e("div",ps,[t[32]||(t[32]=e("label",null,"æè¿°",-1)),_(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.description=a),placeholder:"åˆ—è¡¨æè¿°ï¼ˆå¯é€‰ï¼‰",rows:"3"},null,512),[[H,u.value.description]])])]),e("div",ys,[e("button",{class:"btn-secondary",onClick:t[7]||(t[7]=a=>f.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn-primary",onClick:te},"ä¿å­˜")])])])):$("",!0)]}),_:1}),B(O,{name:"fade"},{default:T(()=>[w.value?(d(),i("div",{key:0,class:"modal-overlay",onClick:t[16]||(t[16]=q(s=>w.value=!1,["self"]))},[e("div",ms,[e("div",_s,[t[33]||(t[33]=e("h3",null,"é…ç½®ç›‘æ§å‚æ•°",-1)),e("button",{class:"close-btn",onClick:t[9]||(t[9]=s=>w.value=!1)},"Ã—")]),n.value?(d(),i("div",hs,[e("div",fs,[e("span",ks,o(n.value.code),1),e("span",bs,o(n.value.name),1)]),e("div",gs,[t[37]||(t[37]=e("h4",null,"åŒæ­¥è®¾ç½®",-1)),e("div",Cs,[e("div",ws,[t[34]||(t[34]=e("label",null,"åŒæ­¥é¢‘ç‡",-1)),_(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>n.value.syncFrequency=s)},[(d(),i(p,null,y(P,s=>e("option",{key:s.value,value:s.value},o(s.label),9,$s)),64))],512),[[X,n.value.syncFrequency]])]),e("div",Ls,[t[35]||(t[35]=e("label",null,"å†å²æ•°æ®èŒƒå›´",-1)),_(e("select",{"onUpdate:modelValue":t[11]||(t[11]=s=>n.value.historyRange=s)},[(d(),i(p,null,y(I,s=>e("option",{key:s.value,value:s.value},o(s.label),9,Ms)),64))],512),[[X,n.value.historyRange]])])]),e("div",As,[e("label",null,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=s=>n.value.syncHistory=s)},null,512),[[E,n.value.syncHistory]]),t[36]||(t[36]=D(" åŒæ­¥å†å²æ•°æ® ",-1))])])]),e("div",xs,[t[38]||(t[38]=e("h4",null,"è®¡ç®—æŒ‡æ ‡",-1)),e("div",Ds,[(d(),i(p,null,y(Z,s=>e("label",{key:s.value,class:"checkbox-item"},[_(e("input",{type:"checkbox",value:s.value,"onUpdate:modelValue":t[13]||(t[13]=a=>n.value.indicators=a)},null,8,Ss),[[E,n.value.indicators]]),D(" "+o(s.label),1)])),64))])]),e("div",Rs,[t[39]||(t[39]=e("h4",null,"è‡ªå®šä¹‰æ ‡ç­¾",-1)),e("div",Vs,[(d(),i(p,null,y(ee,s=>{var a;return e("label",{key:s,class:L(["tag-option",{selected:(a=n.value.tags)==null?void 0:a.includes(s)}])},[_(e("input",{type:"checkbox",value:s,"onUpdate:modelValue":t[14]||(t[14]=r=>n.value.tags=r),hidden:""},null,8,qs),[[E,n.value.tags]]),D(" "+o(s),1)],2)}),64))])])])):$("",!0),e("div",Fs,[e("button",{class:"btn-secondary",onClick:t[15]||(t[15]=s=>w.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn-primary",onClick:oe},"ä¿å­˜é…ç½®")])])])):$("",!0)]),_:1})]))}}),Es=me(Us,[["__scopeId","data-v-cf3e63dd"]]);export{Es as default};
