import{d as D,o as N,c as w,p as s,u as m,E as f,b as F,z as u,D as P,A as h,y as A,B as p,C as v,x as $,r as g,F as B,e as b}from"./vendor-EuZm8Jb1.js";import{u as E}from"./index-o2nft8w4.js";import{M as H}from"./ModeToggle-bHcRDFnx.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"settings-page"},R={class:"page-header"},q={class:"header-left"},G={class:"header-right"},J={class:"page-main"},K={class:"settings-container"},O={class:"settings-sidebar"},Q={class:"user-card"},W={class:"user-avatar"},X={class:"user-info"},Y={class:"user-name"},Z={class:"user-email"},ss={class:"settings-nav"},es={class:"settings-content"},os={key:1,class:"settings-section"},ts={class:"form-group"},rs={class:"form-group"},ns={class:"form-group"},as=["value"],ls=["disabled"],is={key:2,class:"settings-section"},ds={class:"form-group"},us={class:"form-group"},ms={class:"form-group"},ps=["disabled"],vs=D({__name:"SettingsView",setup(cs){const t=E(),k=$(),i=g("profile"),l=g(!1),c=g(""),y=g("success"),n=B({username:"",email:""}),o=B({currentPassword:"",newPassword:"",confirmPassword:""}),S=()=>{t.user&&(n.username=t.user.username||"",n.email=t.user.email||"")};N(()=>{t.initAuth(),S()});const a=(d,e)=>{c.value=d,y.value=e,setTimeout(()=>{c.value=""},3e3)},T=async()=>{if(!n.username||!n.email){a("请填写完整信息","error");return}l.value=!0;try{await t.updateProfile({username:n.username,email:n.email})?a("个人信息更新成功","success"):a(t.error||"更新失败","error")}catch{a("更新失败，请稍后重试","error")}finally{l.value=!1}},z=async()=>{if(!o.currentPassword||!o.newPassword||!o.confirmPassword){a("请填写完整信息","error");return}if(o.newPassword!==o.confirmPassword){a("新密码与确认密码不一致","error");return}if(o.newPassword.length<6){a("新密码长度至少为6位","error");return}l.value=!0;try{await t.changePassword(o.currentPassword,o.newPassword)?(a("密码修改成功","success"),o.currentPassword="",o.newPassword="",o.confirmPassword=""):a(t.error||"密码修改失败","error")}catch{a("密码修改失败，请稍后重试","error")}finally{l.value=!1}},j=()=>{t.logout(),k.push("/login")};return(d,e)=>{var _,x,C,V,M,U;return b(),w("div",I,[s("header",R,[s("div",q,[s("button",{class:"back-btn",onClick:e[0]||(e[0]=r=>m(k).push("/dashboard"))},[...e[8]||(e[8]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})],-1),f(" 返回 ",-1)])]),e[9]||(e[9]=s("h1",{class:"logo"},"CV Algorithm Hub",-1))]),s("div",G,[F(H)])]),s("main",J,[s("div",K,[s("div",O,[s("div",Q,[s("div",W,u(((C=(x=(_=m(t).user)==null?void 0:_.username)==null?void 0:x.charAt(0))==null?void 0:C.toUpperCase())||"U"),1),s("div",X,[s("span",Y,u(((V=m(t).user)==null?void 0:V.username)||"用户"),1),s("span",Z,u(((M=m(t).user)==null?void 0:M.email)||""),1)])]),s("nav",ss,[s("button",{class:P(["nav-item",{active:i.value==="profile"}]),onClick:e[1]||(e[1]=r=>i.value="profile")},[...e[10]||(e[10]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})],-1),f(" 个人信息 ",-1)])],2),s("button",{class:P(["nav-item",{active:i.value==="security"}]),onClick:e[2]||(e[2]=r=>i.value="security")},[...e[11]||(e[11]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"})],-1),f(" 安全设置 ",-1)])],2),s("button",{class:"nav-item logout",onClick:j},[...e[12]||(e[12]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"})],-1),f(" 退出登录 ",-1)])])])]),s("div",es,[c.value?(b(),w("div",{key:0,class:P(["message",y.value])},u(c.value),3)):h("",!0),i.value==="profile"?(b(),w("div",os,[e[16]||(e[16]=s("h2",null,"个人信息",-1)),e[17]||(e[17]=s("p",{class:"section-desc"},"管理您的账户信息",-1)),s("form",{onSubmit:A(T,["prevent"]),class:"settings-form"},[s("div",ts,[e[13]||(e[13]=s("label",{for:"username"},"用户名",-1)),p(s("input",{id:"username","onUpdate:modelValue":e[3]||(e[3]=r=>n.username=r),type:"text",placeholder:"请输入用户名"},null,512),[[v,n.username]])]),s("div",rs,[e[14]||(e[14]=s("label",{for:"email"},"邮箱地址",-1)),p(s("input",{id:"email","onUpdate:modelValue":e[4]||(e[4]=r=>n.email=r),type:"email",placeholder:"请输入邮箱地址"},null,512),[[v,n.email]])]),s("div",ns,[e[15]||(e[15]=s("label",null,"账户创建时间",-1)),s("input",{type:"text",value:((U=m(t).user)==null?void 0:U.created_at)||"未知",disabled:""},null,8,as)]),s("button",{type:"submit",class:"submit-btn",disabled:l.value},u(l.value?"保存中...":"保存修改"),9,ls)],32)])):h("",!0),i.value==="security"?(b(),w("div",is,[e[21]||(e[21]=s("h2",null,"安全设置",-1)),e[22]||(e[22]=s("p",{class:"section-desc"},"修改您的账户密码",-1)),s("form",{onSubmit:A(z,["prevent"]),class:"settings-form"},[s("div",ds,[e[18]||(e[18]=s("label",{for:"currentPassword"},"当前密码",-1)),p(s("input",{id:"currentPassword","onUpdate:modelValue":e[5]||(e[5]=r=>o.currentPassword=r),type:"password",placeholder:"请输入当前密码"},null,512),[[v,o.currentPassword]])]),s("div",us,[e[19]||(e[19]=s("label",{for:"newPassword"},"新密码",-1)),p(s("input",{id:"newPassword","onUpdate:modelValue":e[6]||(e[6]=r=>o.newPassword=r),type:"password",placeholder:"请输入新密码（至少6位）"},null,512),[[v,o.newPassword]])]),s("div",ms,[e[20]||(e[20]=s("label",{for:"confirmPassword"},"确认新密码",-1)),p(s("input",{id:"confirmPassword","onUpdate:modelValue":e[7]||(e[7]=r=>o.confirmPassword=r),type:"password",placeholder:"请再次输入新密码"},null,512),[[v,o.confirmPassword]])]),s("button",{type:"submit",class:"submit-btn",disabled:l.value},u(l.value?"修改中...":"修改密码"),9,ps)],32)])):h("",!0)])])])])}}}),Ps=L(vs,[["__scopeId","data-v-6c808658"]]);export{Ps as default};
